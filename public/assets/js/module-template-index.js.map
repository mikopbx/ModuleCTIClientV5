{"version":3,"sources":["src/module-template-index.js"],"names":["idUrl","idForm","className","inputClassName","ModuleTemplate","$formObj","$","$checkBoxes","$dropDowns","saveRecordAJAXUrl","globalRootUrl","deleteRecordAJAXUrl","$disabilityFields","$statusToggle","$moduleStatus","validateRules","textField","identifier","rules","type","prompt","globalTranslate","mod_tplValidateValueIsEmpty","areaField","passwordField","initialize","window","checkbox","dropdown","checkStatusToggle","addEventListener","initializeForm","get","result","key","tableName","attr","undefined","initTable","makeDropdownList","selectType","selected","values","name","value","each","index","obj","push","text","changeGroupInList","choice","tdInput","closest","find","currentRowId","replace","sendChangesToServer","options","columns","columnsArray4Sort","colName","data","DataTable","ajax","url","ajaxUrl","dataSrc","paging","sDom","deferRender","pageLength","language","SemanticLocalization","dataTableLocalisation","ordering","createdRow","row","cols","headers","indexOf","eq","html","templateDeleteButton","id","DT_RowId","bt_ToolTipDelete","template","additionalClass","addClass","header","selectMetaData","newTemplate","drawCallback","settings","drowSelectGroup","sTableId","body","on","e","target","transition","removeClass","document","keyCode","which","hasClass","changeFunc","preventDefault","deleteRow","addNewRow","endEditInput","$el","idTable","table","remove","Math","floor","random","rowTemplate","before","tableId","hide","selestGroup","onChange","substr","api","onSuccess","response","success","length","append","recordId","notEmpty","val","method","successTest","Object","keys","rowId","onFailure","message","UserMessage","showMultiString","onError","errorMessage","element","xhr","status","location","show","applyConfigurationChanges","changeStatus","Config","pbxUrl","cbBeforeSendForm","form","cbAfterSendForm","Form","mod_tpl_Connected","mod_tpl_Disconnected","mod_tpl_UpdateStatus","ready"],"mappings":"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","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 11 2018\n *\n */\nconst idUrl     = 'module-template';\nconst idForm    = 'module-template-form';\nconst className = 'ModuleTemplate';\nconst inputClassName = 'mikopbx-module-input';\n\n/* global globalRootUrl, globalTranslate, Form, Config */\nconst ModuleTemplate = {\n\t$formObj: $('#'+idForm),\n\t$checkBoxes: $('#'+idForm+' .ui.checkbox'),\n\t$dropDowns: $('#'+idForm+' .ui.dropdown'),\n\tsaveRecordAJAXUrl: globalRootUrl + idUrl + \"/save\",\n\tdeleteRecordAJAXUrl: globalRootUrl + idUrl + \"/delete\",\n\t$disabilityFields: $('#'+idForm+'  .disability'),\n\t$statusToggle: $('#module-status-toggle'),\n\t$moduleStatus: $('#status'),\n\t/**\n\t * Field validation rules\n\t * https://semantic-ui.com/behaviors/form.html\n\t */\n\tvalidateRules: {\n\t\ttextField: {\n\t\t\tidentifier: 'text_field',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.mod_tplValidateValueIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tareaField: {\n\t\t\tidentifier: 'text_area_field',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.mod_tplValidateValueIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tpasswordField: {\n\t\t\tidentifier: 'password_field',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.mod_tplValidateValueIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t},\n\t/**\n\t * On page load we init some Semantic UI library\n\t */\n\tinitialize() {\n\t\t// инициализируем чекбоксы и выподающие менюшки\n\t\twindow[className].$checkBoxes.checkbox();\n\t\twindow[className].$dropDowns.dropdown();\n\t\twindow[className].checkStatusToggle();\n\t\twindow.addEventListener('ModuleStatusChanged', window[className].checkStatusToggle);\n\t\twindow[className].initializeForm();\n\n\t\t$.get( idUrl + '/getTablesDescription', function( result ) {\n\t\t\tfor (let key in result['data']) {\n\t\t\t\tlet tableName = key + '-table';\n\t\t\t\tif( $('#'+tableName).attr('id') === undefined){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\twindow[className].initTable(tableName, result['data'][key]);\n\t\t\t}\n\t\t});\n\t},\n\t/**\n\t * Подготавливает список выбора\n\t * @param selected\n\t * @returns {[]}\n\t */\n\tmakeDropdownList(selectType, selected) {\n\t\tconst values = [\n\t\t\t{\n\t\t\t\tname: ' --- ',\n\t\t\t\tvalue: '',\n\t\t\t\tselected: ('' === selected),\n\t\t\t}\n\t\t];\n\t\t$('#'+selectType+' option').each((index, obj) => {\n\t\t\tvalues.push({\n\t\t\t\tname: obj.text,\n\t\t\t\tvalue: obj.value,\n\t\t\t\tselected: (selected === obj.value),\n\t\t\t});\n\t\t});\n\t\treturn values;\n\t},\n\t/**\n\t * Обработка изменения группы в списке\n\t */\n\tchangeGroupInList(value, text, choice) {\n\t\tlet tdInput = $(choice).closest('td').find('input');\n\t\ttdInput.attr('data-value', \tvalue);\n\t\ttdInput.attr('value', \t\tvalue);\n\t\tlet currentRowId = $(choice).closest('tr').attr('id');\n\t\tlet tableName    = $(choice).closest('table').attr('id').replace('-table', '');\n\t\tif (currentRowId !== undefined && tableName !== undefined) {\n\t\t\twindow[className].sendChangesToServer(tableName, currentRowId);\n\t\t}\n\t},\n\n\t/**\n\t * Add new Table.\n\t */\n\tinitTable(tableName, options) {\n\t\tlet columns = [];\n\t\tlet columnsArray4Sort = []\n\t\tfor (let colName in options['cols']) {\n\t\t\tcolumns.push( {data: colName});\n\t\t\tcolumnsArray4Sort.push(colName);\n\t\t}\n\t\t$('#' + tableName).DataTable( {\n\t\t\tajax: {\n\t\t\t\turl: idUrl + options.ajaxUrl + '?table=' +tableName.replace('-table', ''),\n\t\t\t\tdataSrc: 'data'\n\t\t\t},\n\t\t\tcolumns: columns,\n\t\t\tpaging: true,\n\t\t\tsDom: 'rtip',\n\t\t\tdeferRender: true,\n\t\t\tpageLength: 17,\n\t\t\tlanguage: SemanticLocalization.dataTableLocalisation,\n\t\t\tordering: false,\n\t\t\t/**\n\t\t\t * Builder row presentation\n\t\t\t * @param row\n\t\t\t * @param data\n\t\t\t */\n\t\t\tcreatedRow(row, data) {\n\t\t\t\tlet cols    = $('td', row);\n\t\t\t\tlet headers = $('#'+ tableName + ' thead tr th');\n\t\t\t\tfor (let key in data) {\n\t\t\t\t\tlet index = columnsArray4Sort.indexOf(key);\n\t\t\t\t\tif(key === 'rowIcon'){\n\t\t\t\t\t\tcols.eq(index).html('<i class=\"ui ' + data[key] + ' circle icon\"></i>');\n\t\t\t\t\t}else if(key === 'delButton'){\n\t\t\t\t\t\tlet templateDeleteButton = '<div class=\"ui small basic icon buttons action-buttons\">' +\n\t\t\t\t\t\t\t'<a href=\"' + window[className].deleteRecordAJAXUrl + '/' +\n\t\t\t\t\t\t\tdata.id + '\" data-value = \"' + data.DT_RowId + '\"' +\n\t\t\t\t\t\t\t' class=\"ui button delete two-steps-delete popuped\" data-content=\"' + globalTranslate.bt_ToolTipDelete + '\">' +\n\t\t\t\t\t\t\t'<i class=\"icon trash red\"></i></a></div>';\n\t\t\t\t\t\tcols.eq(index).html(templateDeleteButton);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tlet template = '<div class=\"ui transparent fluid input inline-edit\">' +\n\t\t\t\t\t\t\t'<input colName=\"'+key+'\" class=\"'+inputClassName+'\" type=\"text\" data-value=\"'+data[key] + '\" value=\"' + data[key] + '\"></div>';\n\t\t\t\t\t\t$('td', row).eq(index).html(template);\n\t\t\t\t\t}\n\t\t\t\t\tif(options['cols'][key] === undefined){\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tlet additionalClass = options['cols'][key]['class'];\n\t\t\t\t\tif(additionalClass !== undefined && additionalClass !== ''){\n\t\t\t\t\t\theaders.eq(index).addClass(additionalClass);\n\t\t\t\t\t}\n\t\t\t\t\tlet header = options['cols'][key]['header'];\n\t\t\t\t\tif(header !== undefined && header !== ''){\n\t\t\t\t\t\theaders.eq(index).html(header);\n\t\t\t\t\t}\n\n\t\t\t\t\tlet selectMetaData = options['cols'][key]['select'];\n\t\t\t\t\tif(selectMetaData !== undefined){\n\t\t\t\t\t\tlet newTemplate = $('#template-select').html().replace('PARAM', data[key]);\n\t\t\t\t\t\tlet template = '<input class=\"'+inputClassName+'\" colName=\"'+key+'\" selectType=\"'+selectMetaData+'\" style=\"display: none;\" type=\"text\" data-value=\"'+data[key] + '\" value=\"' + data[key] + '\"></div>';\n\t\t\t\t\t\tcols.eq(index).html(newTemplate + template);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * Draw event - fired once the table has completed a draw.\n\t\t\t */\n\t\t\tdrawCallback(settings) {\n\t\t\t\twindow[className].drowSelectGroup(settings.sTableId);\n\t\t\t},\n\t\t} );\n\n\t\tlet body = $('body');\n\t\t// Клик по полю. Вход для редактирования значения.\n\t\tbody.on('focusin', '.'+inputClassName, function (e) {\n\t\t\t$(e.target).transition('glow');\n\t\t\t$(e.target).closest('div').removeClass('transparent').addClass('changed-field');\n\t\t\t$(e.target).attr('readonly', false);\n\t\t})\n\t\t// Отправка формы на сервер по Enter или Tab\n\t\t$(document).on('keydown', function (e) {\n\t\t\tlet keyCode = e.keyCode || e.which;\n\t\t\tif (keyCode === 13 || keyCode === 9 && $(':focus').hasClass('mikopbx-module-input')) {\n\t\t\t\twindow[className].changeFunc();\n\t\t\t}\n\t\t});\n\n\t\tbody.on('click', 'a.delete', function (e) {\n\t\t\te.preventDefault();\n\t\t\tlet currentRowId = $(e.target).closest('tr').attr('id');\n\t\t\tlet tableName    = $(e.target).closest('table').attr('id').replace('-table', '');\n\t\t\twindow[className].deleteRow(tableName, currentRowId);\n\t\t}); // Добавление новой строки\n\n\t\t// Отправка формы на сервер по уходу с поля ввода\n\t\tbody.on('focusout', '.'+inputClassName, window[className].changeFunc);\n\n\t\t// Кнопка \"Добавить новую запись\"\n\t\t$('[id-table = \"'+tableName+'\"]').on('click', window[className].addNewRow);\n\t},\n\n\t/**\n\t * Окончание редактирования поля ввода.\n\t * Не относится к select.\n\t * @param e\n\t */\n\tendEditInput(e){\n\t\tlet $el = $('.changed-field').closest('tr');\n\t\t$el.each(function (index, obj) {\n\t\t\tlet currentRowId = $(obj).attr('id');\n\t\t\tlet tableName    = $(obj).closest('table').attr('id').replace('-table', '');\n\t\t\tif (currentRowId !== undefined && tableName !== undefined) {\n\t\t\t\twindow[className].sendChangesToServer(tableName, currentRowId);\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Добавление новой строки в таблицу.\n\t * @param e\n\t */\n\taddNewRow(e){\n\t\tlet idTable = $(e.target).attr('id-table');\n\t\tlet table   = $('#'+idTable);\n\t\te.preventDefault();\n\t\ttable.find('.dataTables_empty').remove();\n\t\t// Отправим на запись все что не записано еще\n\t\tlet $el = table.find('.changed-field').closest('tr');\n\t\t$el.each(function (index, obj) {\n\t\t\tlet currentRowId = $(obj).attr('id');\n\t\t\tif (currentRowId !== undefined) {\n\t\t\t\twindow[className].sendChangesToServer(currentRowId);\n\t\t\t}\n\t\t});\n\t\tlet id = \"new\"+Math.floor(Math.random() * Math.floor(500));\n\t\tlet rowTemplate = '<tr id=\"'+id+'\" role=\"row\" class=\"even\">'+table.find('tr#TEMPLATE').html().replace('TEMPLATE', id)+'</tr>';\n\t\ttable.find('tbody > tr:first').before(rowTemplate);\n\t\twindow[className].drowSelectGroup(idTable);\n\t},\n\t/**\n\t * Обновление select элементов.\n\t * @param tableId\n\t */\n\tdrowSelectGroup(tableId) {\n\t\t$('#' + tableId).find('tr#TEMPLATE').hide();\n\t\tlet selestGroup = $('.select-group');\n\t\tselestGroup.each((index, obj) => {\n\t\t\tlet selectType = $(obj).closest('td').find('input').attr('selectType');\n\t\t\t$(obj).dropdown({\n\t\t\t\tvalues: window[className].makeDropdownList(selectType, $(obj).attr('data-value')),\n\t\t\t});\n\t\t});\n\t\tselestGroup.dropdown({\n\t\t\tonChange: window[className].changeGroupInList,\n\t\t});\n\t},\n\t/**\n\t * Удаление строки\n\t * @param tableName\n\t * @param id - record id\n\t */\n\tdeleteRow(tableName, id) {\n\t\tlet table = $('#'+ tableName+'-table');\n\t\tif (id.substr(0,3) === 'new') {\n\t\t\ttable.find('tr#'+id).remove();\n\t\t\treturn;\n\t\t}\n\t\t$.api({\n\t\t\turl: window[className].deleteRecordAJAXUrl+'?id='+id+'&table='+tableName,\n\t\t\ton: 'now',\n\t\t\tonSuccess(response) {\n\t\t\t\tif (response.success) {\n\t\t\t\t\ttable.find('tr#'+id).remove();\n\t\t\t\t\tif (table.find('tbody > tr').length === 0) {\n\t\t\t\t\t\ttable.find('tbody').append('<tr class=\"odd\"></tr>');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Отправка данных на сервер при измении\n\t */\n\tsendChangesToServer(tableName, recordId) {\n\t\tlet data = { 'pbx-table-id': tableName, 'pbx-row-id':  recordId};\n\t\tlet notEmpty = false;\n\t\t$(\"tr#\"+recordId + ' .' + inputClassName).each(function (index, obj) {\n\t\t\tlet colName = $(obj).attr('colName');\n\t\t\tif(colName !== undefined){\n\t\t\t\tdata[$(obj).attr('colName')] = $(obj).val();\n\t\t\t\tif($(obj).val() !== ''){\n\t\t\t\t\tnotEmpty = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif(notEmpty === false){\n\t\t\treturn;\n\t\t}\n\t\t$(\"tr#\"+recordId+\" .user.circle\").removeClass('user circle').addClass('spinner loading');\n\t\t$.api({\n\t\t\turl: window[className].saveRecordAJAXUrl,\n\t\t\ton: 'now',\n\t\t\tmethod: 'POST',\n\t\t\tdata: data,\n\t\t\tsuccessTest(response) {\n\t\t\t\treturn response !== undefined && Object.keys(response).length > 0 && response.success === true;\n\t\t\t},\n\t\t\tonSuccess(response) {\n\t\t\t\tif (response.data !== undefined) {\n\t\t\t\t\tlet rowId = response.data['pbx-row-id'];\n\t\t\t\t\tlet table = $('#'+response.data['pbx-table-id']+'-table');\n\t\t\t\t\ttable.find(\"tr#\" + rowId + \" input\").attr('readonly', true);\n\t\t\t\t\ttable.find(\"tr#\" + rowId + \" div\").removeClass('changed-field loading').addClass('transparent');\n\t\t\t\t\ttable.find(\"tr#\" + rowId + \" .spinner.loading\").addClass('user circle').removeClass('spinner loading');\n\n\t\t\t\t\tif (rowId !== response.data['newId']){\n\t\t\t\t\t\t$(`tr#${rowId}`).attr('id', response.data['newId']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tonFailure(response) {\n\t\t\t\tif (response.message !== undefined) {\n\t\t\t\t\tUserMessage.showMultiString(response.message);\n\t\t\t\t}\n\t\t\t\t$(\"tr#\" + recordId + \" .spinner.loading\").addClass('user circle').removeClass('spinner loading');\n\t\t\t},\n\t\t\tonError(errorMessage, element, xhr) {\n\t\t\t\tif (xhr.status === 403) {\n\t\t\t\t\twindow.location = globalRootUrl + \"session/index\";\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t/**\n\t * Change some form elements classes depends of module status\n\t */\n\tcheckStatusToggle() {\n\t\tif (window[className].$statusToggle.checkbox('is checked')) {\n\t\t\twindow[className].$disabilityFields.removeClass('disabled');\n\t\t\twindow[className].$moduleStatus.show();\n\t\t} else {\n\t\t\twindow[className].$disabilityFields.addClass('disabled');\n\t\t\twindow[className].$moduleStatus.hide();\n\t\t}\n\t},\n\t/**\n\t * Send command to restart module workers after data changes,\n\t * Also we can do it on TemplateConf->modelsEventChangeData method\n\t */\n\tapplyConfigurationChanges() {\n\t\twindow[className].changeStatus('Updating');\n\t\t$.api({\n\t\t\turl: `${Config.pbxUrl}/pbxcore/api/modules/`+className+`/reload`,\n\t\t\ton: 'now',\n\t\t\tsuccessTest(response) {\n\t\t\t\t// test whether a JSON response is valid\n\t\t\t\treturn Object.keys(response).length > 0 && response.result === true;\n\t\t\t},\n\t\t\tonSuccess() {\n\t\t\t\twindow[className].changeStatus('Connected');\n\t\t\t},\n\t\t\tonFailure() {\n\t\t\t\twindow[className].changeStatus('Disconnected');\n\t\t\t},\n\t\t});\n\t},\n\t/**\n\t * We can modify some data before form send\n\t * @param settings\n\t * @returns {*}\n\t */\n\tcbBeforeSendForm(settings) {\n\t\tconst result = settings;\n\t\tresult.data = window[className].$formObj.form('get values');\n\t\treturn result;\n\t},\n\t/**\n\t * Some actions after forms send\n\t */\n\tcbAfterSendForm() {\n\t\twindow[className].applyConfigurationChanges();\n\t},\n\t/**\n\t * Initialize form parameters\n\t */\n\tinitializeForm() {\n\t\tForm.$formObj = window[className].$formObj;\n\t\tForm.url = `${globalRootUrl}${idUrl}/save`;\n\t\tForm.validateRules = window[className].validateRules;\n\t\tForm.cbBeforeSendForm = window[className].cbBeforeSendForm;\n\t\tForm.cbAfterSendForm = window[className].cbAfterSendForm;\n\t\tForm.initialize();\n\t},\n\t/**\n\t * Update the module state on form label\n\t * @param status\n\t */\n\tchangeStatus(status) {\n\t\tswitch (status) {\n\t\t\tcase 'Connected':\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('grey')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.addClass('green');\n\t\t\t\twindow[className].$moduleStatus.html(globalTranslate.mod_tpl_Connected);\n\t\t\t\tbreak;\n\t\t\tcase 'Disconnected':\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('green')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.addClass('grey');\n\t\t\t\twindow[className].$moduleStatus.html(globalTranslate.mod_tpl_Disconnected);\n\t\t\t\tbreak;\n\t\t\tcase 'Updating':\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('green')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.addClass('grey');\n\t\t\t\twindow[className].$moduleStatus.html(`<i class=\"spinner loading icon\"></i>${globalTranslate.mod_tpl_UpdateStatus}`);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('green')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.addClass('grey');\n\t\t\t\twindow[className].$moduleStatus.html(globalTranslate.mod_tpl_Disconnected);\n\t\t\t\tbreak;\n\t\t}\n\t},\n};\n\n$(document).ready(() => {\n\twindow[className].initialize();\n});\n\n"],"file":"module-template-index.js"}